<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Dense Pixel Circle</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    background-color: black;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }
  canvas {
    image-rendering: pixelated;
    display: block;
    max-width: 100%;
    max-height: 100%;
  }
</style>
</head>
<body>
<canvas id="px"></canvas>

<script>
const canvas = document.getElementById('px');
const ctx = canvas.getContext('2d');

let N = 10000; // количество пикселей в круге
let logicalSize = 400; // логический размер canvas

canvas.width = logicalSize;
canvas.height = logicalSize;

// Цвета
const gray     = [0x26, 0x2C, 0x36, 255];
const cyan     = [0x00, 0xFF, 0xFF, 255];
const magenta  = [0xFF, 0x00, 0xFF, 255];
const mixColor = [0x80, 0x80, 0xFF, 255];

const probs = { gray:0.5, magenta:0.15, cyan:0.3, mix:0.05 };

function getRandomColor(){
    const p = Math.random();
    if(p < probs.gray) return gray;
    if(p < probs.gray + probs.magenta) return magenta;
    if(p < probs.gray + probs.magenta + probs.cyan) return cyan;
    return mixColor;
}

function generateDenseCircle(){
    ctx.fillStyle = 'black';
    ctx.fillRect(0,0,logicalSize,logicalSize);

    const cx = logicalSize/2;
    const cy = logicalSize/2;
    const R = logicalSize/2;

    // Площадь круга и шаг между пикселями
    const pixelArea = Math.PI * R*R / N;
    const step = Math.sqrt(pixelArea);

    // Построчное заполнение круга
    for(let y = -R + step/2; y <= R; y += step){
        const dx = Math.sqrt(R*R - y*y); // горизонтальный радиус на этой строке
        const nPix = Math.floor(2*dx / step);
        for(let i=0; i<nPix; i++){
            const x = -dx + step/2 + i*step;
            const [r,g,b,a] = getRandomColor();
            const img = ctx.createImageData(1,1);
            const d = img.data;
            d[0]=r; d[1]=g; d[2]=b; d[3]=a;
            ctx.putImageData(img, Math.round(cx + x), Math.round(cy + y));
        }
    }
}

// Масштабирование под окно
function resizeCanvas(){
    const size = Math.min(window.innerWidth, window.innerHeight);
    canvas.style.width = size + 'px';
    canvas.style.height = size + 'px';
}

window.addEventListener('resize', resizeCanvas);
canvas.addEventListener('click', generateDenseCircle);

generateDenseCircle();
resizeCanvas();
</script>
</body>
</html>
